### Transaction

- 트랜잭션(Transaction)이란?
    - 데이터베이스의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위 또는 한꺼번에 모두 수행되어야 할 일련의 연산
    - **하나의 작업을 수행하기 위해 필요한 데이터베이스의 연산들을 모아놓은 것**
- 트랜잭션과 Lock
- 트랜잭션의 특징(ACID)
    - **Atomicity(원자성)**
        - 트랜잭션의 연산은 데이터베이스에 모두 반영 OR 반영되지 않아야한다.
        - **트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수되지 않고 어느하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 한다(Rollback).**
    - **Consistency(일관성)**
        - **트랜잭션이 그 실행을 성공적으로 완료하면 언제나 일관성이 있는 데이터베이스 상태로 변환한다**
        - 시스템이 가지고 있는 고정요소는 트랜잭션 수행 전과 트랜잭션 수행 완료 후의 상태가 같아야 한다.
    - **Isolation(독립성, 격리성)**
        - 둘 이상의 트랜잭션이 동시에 병행 실행되는 경우 어느 하나의 트랜잭션 실행중에 다른 트랜잭션의 연산이 끼어들 수 없다.
        - **수행중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.**
    - **Durability(영속성, 지속성)**
        - **성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반영되어야 한다.**
- 트랜잭션의 상태
    
    ![Untitled](https://github.com/5dotseven/cs-basic-study/assets/118906074/89627b04-695c-4cfa-bcca-94caa3854fdc)
    
    - **활동(Active)** : 트랜잭션이 실행중인 상태
    - **실패(Failed)** : 트랜잭션 실행에 오류가 발생하여 중단된 상태
    - **철회(Aborted)** : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태
    - **부분 완료(Partially Committed)** : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전의 상태
    - **완료(Committed)** : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태
    - **Partially Committed VS Committed**
        - `Commit` 요청이 들어오면 상태는 `Partial Commited` 상태가 된다. 
        이후 `Commit`을 문제없이 수행할 수 있으면 `Committed` 상태로 전이되고, 
        만약 오류가 발생하면 `Failed` 상태가 된다. 
        →`Partial Commited`는 `Commit` 요청이 들어왔을때를 말하며, 
            `Commited`는 `Commit`을 정상적으로 완료한 상태를 말한다.
- **트랜잭션의 연산**
    - **Commit 연산**
        - 한 개의 논리적 단위(트랜잭션)에 대한 작업이 성공적으로 끝났고,
         데이터베이스가 다시 일관된 상태에 있을 때, 이 트랜잭션이 행한 갱신 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산
        - `Commit`을 수행하면 이전 데이터가 완전히 UPDATE 된다.
    - **Roolback 연산**
        - 하나의 트랜잭션 처리가 비정상적으로 종료되어 데이터베이스의 일관성을 깨뜨렸을 때, 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 `원자성`을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소하는 연산
        - Rollback을 수행하면 해당 트랜잭션을 시작하거나 폐기한다
- 격리수

**트랜잭션**

- 트랜잭션을 사용할 때 주의할 점 → 교착상태 발생
- 교착상태란?
    - 복수의 트랜잭션을 사용하다보면 교착상태가 일어날수 있다. 
    `교착상태`란 두 개 이상의 트랜잭션이 특정 자원(테이블 또는 행)의 잠금(Lock)을 획득한 채 다른 트랜잭션이 소유하고 있는 잠금을 요구하면 아무리 기다려도 상황이 바뀌지 않는 상태가 되는 것

출처

- https://repeater2487.tistory.com/39
- [https://chanhan.tistory.com/entry/CS-트랜잭션이란-SpringSpring-Boot](https://chanhan.tistory.com/entry/CS-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98%EC%9D%B4%EB%9E%80-SpringSpring-Boot)
- [https://velog.io/@wonizizi99/CS-트랜잭션-Transaction](https://velog.io/@wonizizi99/CS-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-Transaction)