# 쿼리 진행 순서

## SQL 스크립트 순서

> SELECT - FROM - WHERE - GROUP BY - HAVING - ORDER BY
> 

## SQL 쿼리 진행 순서

다양한 SQL이 존재하기 때문에 각각 순서는 다르지만 일반적으론 크게 아래와 같이 이해하고 있으면 된다.

**FROM** - **JOIN ON** - **WHERE - GROUP** **BY - HAVING- SELECT - DISTINCT - ORDER** **BY - LIMIT/OFFSET**

### 실행 순서에 따른 최적화

1. 쿼리의 진행 순서가 위와 같음으로 최대한 where 절에서 가져오는 데이터를 줄이는 것이 성능상 유리하다.
2. LIMIT/OFFSET 의 경우 OFFSET의 값이 커질 수록 성능이 떨어진다. 그 이유는 해당 값까지 데이터를 읽어 온 후 그 후 LIMIT을 적용하기 때문이다. 이러한 경우에 최적화를 하기 위해서는 2가지 방법이 있을 수 있을 것 같다.
    1. 인덱스를 활용한 방법 
        - 인덱싱이 되어 있는 컬럼을 활용하여 대상을 좁힌다. where절로 특정 pk 이상부터 LIMIT을 거는 등의 최적화가 가능할 것이다.
    2. ORDER BY 를 통한 최적화 ORDER BY는 LIMIT/OFFSET 보다 먼저 실행됨으로 조회된 데이터를 거꾸로 정렬해 둔 상태에서 LIMIT/OFFSET을 하는 방식도 생각해 볼 수 있다. 단 이 경우 특정 값을 기대하고 가져오기는 힘들다.
3. INNER JOIN 의 경우 FROM 절에 해당하는 데이터가 적을 수록 유리할 것 같다.
   
   3-1. 3개 이상의 테이블의 Join을 실행할 시에는 FROM 절에 많은 데이터 테이블을 두는것이 권장된다.
4. 서브쿼리의 경우 위와 같은 진행 순서가 두번 반복됨으로 한 사이클 내에 있는 JOIN 문이 대다수 상황에서 좋은 성능을 낸다. 특정 상황 (**FORM 절에서 서브쿼리 사용, 서브쿼리가 집계함수의 결과 값인 상황** 등)을 제외하고는 **JOIN을 통한 조회가 권장된다.**