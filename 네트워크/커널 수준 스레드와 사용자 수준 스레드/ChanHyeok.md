### 커널 수준 스레드와 사용자 수준 스레드

- **커널 수준 스레드**

  ![Untitled](https://github.com/5dotseven/cs-basic-study/assets/118906074/bc985ffd-b83f-481a-bab1-0be1d5179fe5)

    - 커널 레벨에서 생성되는 스레드
    - 운영체제 시스템 내에서 생성되어 동작하는 스레드로, 커널이 직접 관리
    - CPU에서 실제로 실행되는 단위(CPU 스케줄링의 단위)
    - 커널이 스레드와 관련된 모든 작업을 관리하는 방식
    - 사용자 수준 스레드와 커널 수준 스레드가 1대1로 매핑

  ![Untitled](https://github.com/5dotseven/cs-basic-study/assets/118906074/2d9f041a-862e-4cd2-881e-a53af68c8bb8)

- 스케줄러가 스레드1, 스레드2, 스레드3을 직접 관리
    - 각 스레드의 우선 순위가 동일하다고 가정하면 1/3 만큼 시간을 할당 받아 실행
    - 스레드1이 IO 상태가 되어도 나머지 스레드2, 스레드3은 상관없이 스케줄링 되어 실행 된다.<br></br>

- 장점
    - 커널이 각 스레드들을 개별적으로 관리할 수 있으므로, 동일한 프로세스에서 할당된 여러개의 스레드들 중 한 스레드가 대기상태가 되더라도, 다른 스레드들은 실행시킬 수 있다.<br></br>
- 단점
    - 커널이 직접 스케줄링하고 실행하기 때문에 커널의 관리 지원을 많이 받을 수 있지만, 그 만큼 오버헤드가 늘어난다.<br></br>

- **사용자 수준 스레드**

  ![Untitled](https://github.com/5dotseven/cs-basic-study/assets/118906074/baf4418f-b15c-45c5-b199-599044b03b7b)

    - 사용자 단에서 스레드 관련 라이브러리로 구현해 생성 및 관리되는 스레드
    - 스레드와 관련된 모든 행위를 사용자 영역에서 하기 때문에, 커널은 사용자 수준 스레드의 존재를 알지 못하고, 스레드 교환에 개입하지 않는다.
    - 사용자 수준 스레드 N개가 커널 수준 스레드 1개에 매핑되므로, 다대일 스레드 매핑
    - 스레드 개념을 프로그래밍 레벨에서 추상화 한 것
    - 유저 스레드가 cpu에서 실행되려면 커널 스레드와 반드시 연결되어야 한다.

  ![Untitled](https://github.com/5dotseven/cs-basic-study/assets/118906074/a11a51bf-df45-4db2-982f-5733e07ec987)

    - 스케줄러가 직접 스레드를 관리 X
      → 스케줄러는 사용자 수준 스레드를 알 수 없고, 단순히 사용자 영역에서 작성한 코드로 인해 스레드가 실행 됨
    - 프로세스 A, 프로세스 B의 우선 순위가 동일하다고 가정하면 1/2만큼 시간을 할당 받아 실행
      → 스레드1 과 스레드2 또한 우선 순위가 동일 하면 1/4 , 1/4 만큼 시간을 할당 받고 스레드3은 1/2 만큼 시간을 할당 받아 실행 된다.
    - **스레드1이 IO 상태가 되면 스레드2에 시간을 할당하는 것이 아님.
      스케줄러는 스레드의 존재를 모르고 있기 때문에 단순히 프로세스A가 IO상태가 되었구나라고 생각하여 프로세스B(스레드3)를 실행시켜야 겠다고 생각함.** 
    →해결하기 위해 Non Blocking IO<br></br>
- 장점
    - 커널에 독립적으로 스케줄링을 할 수 있어 모든 운영체제에 적용할 수 있다. 이식성이 높다.
    - 스케줄링이나 동기화를 위해 커널을 호출하지 않으므로, 커널 영역으로 전환하는 오버헤드가 줄어든다.
    - 커널이 아닌 스레드 라이브러리에서 스레드 스케줄링을 제어하므로, 유연한 스케줄링이 가능하다.<br></br>
- 단점
    - 하나의 프로세스로부터 할당된 여러개의 스레드들 중, 한 스레드가 대기 상태가 되면, 모든 스레드들을 실행시킬 수 없게 된다.
    - 커널이 스레드 관리에 개입하지 않으므로, 스레드 간 보호에 커널의 보호 방법을 사용할 수 없다. 라이브러리 수준의 보호 방법까지만 사용 가능하다.

출처

- [https://velog.io/@chanyoung1998/스레드의-종류하드웨어-스레드-OS-스레드-유저-레벨-스레드](https://velog.io/@chanyoung1998/%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%A2%85%EB%A5%98%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4-%EC%8A%A4%EB%A0%88%EB%93%9C-OS-%EC%8A%A4%EB%A0%88%EB%93%9C-%EC%9C%A0%EC%A0%80-%EB%A0%88%EB%B2%A8-%EC%8A%A4%EB%A0%88%EB%93%9C)
- https://junghyungil.tistory.com/132