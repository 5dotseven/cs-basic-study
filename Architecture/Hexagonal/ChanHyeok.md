### 헥사고날 아키텍처

![image](https://github.com/5dotseven/cs-basic-study/assets/118906074/8c9354b4-5ba9-486c-826e-d5051da0a5c4)
- 정의
    - 사전적 의미로는 ”육각형 건축물”을 의미합니다.
    - 소프트웨어 설계에 사용되는 아키텍처 패턴중 하나로 여러 소프트웨어 환경에 쉽게 연결할 수 있도록, 느슨하게 결합된 애플리케이션 구성요소를 만드는 것을 목표로 하는 아키텍처
    - 도메인의 비즈니스 로직을 외부 라이브러리 및 툴로부터 분리 할 때 포트와 어댑터라고 부르는 인터페이스를 사용하기 때문에 **포트&어댑터 아키텍처**라고도 부릅니다<br></br>
- 특징
    - 도메인 비즈니스 로직이 외부요소에 의존하지 않게 만들고, 프레젠테이션 계층(controller)과 데이터 소스 계층(persistence) 같은 외부 요소들이 도메인 계층에 의존하도록 합니다.

      → 외부와의 접촉을 인터페이스로 추상화하여 비즈니스 로직 안에 외부 코드나 로직의 주입을 막는 것, 외부 라이브러리 및 툴로부터 분리

    - 레이어 간 원치 않은 종속성과 비즈니스 로직으로 인한 사용자 인터페이스 코드의 오염과 같은 객체 지향 소프트웨어 설계의 구조적 함정을 피함<br></br>
- **장단점**
    - **장점**
        - 외부 시스템이나 인프라와의 의존성을 낮추어, 구성 요소를 쉽게 교체하거나 업데이트 가능
        - 비즈니스 로직을 독립적으로 테스트할 수 있어 품질 향상과 개발 속도 향상에 도움이 됩니다.
        - 책임이 분리되어 있어, 코드의 이해와 수정이 용이하며 변화에 빠르게 대응할 수 있습니다.<br></br>
    - **단점**
        - 포트와 어댑터를 구성하고 관리하는 데 복잡성이 생김
        - 아키텍처를 처음 구축할 때 시간과 노력이 더 필요할 수 있음
        - **코드가 많아진다.**
            - 도메인 계층이 영속성, UI같은 외부계층과 철저히 분리되어야 하기 때문에 엔티티에 대한 모델을 각 계층에서 유지보수 필요
        - 불필요한 오버헤드
            - 아키텍처를 도입하기 전 포트,어댑터 등 알아야할 개념이 생기고, 아키텍쳐를 구현하기 위해서는 포트(인터페이스)를 생성해야 하고 도메인 모델의 여러 표현 사이를 매핑할 객체를 만들어야 합니다.
              <br></br>
### 헥사고날 아키텍처의 구성

![image (1)](https://github.com/5dotseven/cs-basic-study/assets/118906074/f6010720-d497-477a-a5c0-c5c3f133f426)
- 내부(도메인)와 외부(인프라)로 구분
- **내부 영역**
    - 순수한 비즈니스 로직을 표현하며 캡슐화된 영역이고 기능적 요구사항에 따라 먼저 설계
- **외부 영역**
    - 내부 영역에서 기술을 분리하여 구성한 영역이고 내부 영역 설계 이후 설계

### **포트와 어댑터**

(도메인 + application layer 까지 비즈니스 로직)

**포트**

- Port는 application 입장에서 consumer, 또는 application에서 나가거나/들어오는 end point
- 내부 비즈니스 영역을 외부 영역에 노출한 API이고 인바운드(Inbound)/아웃바운드(Outbound) 포트로 구분
- DI를 위한 추상화 인터페이스
- **인바운드 포트**
    - 내부 영역 사용을 위해 노출된 API
- **아웃바운드 포트**
    - 내부 영역이 외부 영역을 사용하기 위한 API

**어댑터**

- 포트를 통해 인프라와 실제로 연결하는 부분만 담당하는 구현체
- 인프라나 web과 같은 저수준 layer들이 도메인 로직에 접근할 수 있는 포트를 사용할 수 있도록 함
- **Primary (Driving) Adapters** (Controller)
    - 위의 다이어그램에서 왼쪽에 있는 adapter, application을 동작시키는(Driving) 역할을 한다. Driving Adapter에는 주로 UI 쪽이 들어간다. 인바운드 포트 사용
- **Secondary (Driven)** **Adapters** - 오른쪽에 있는 adapter, application에 의해 동작되는(Driven) 역할을 가진 부분이다. 주로 인프라와 연결되는 부분이 들어간다. 아웃바운드 포트 사용
    - Primary adapter에 의해 Secondary adapter들이 호출된다. (인바운드 adapter, 아웃바운드 adapter로 부르기도 한다)


**+두 종류의 adapter에서 어떻게 port와 adapter가 쓰이는지에 대한 차이점**

- **Primary adapter는 port에 의존**
    - 실제로 사용될 때는 구체적인 port의 구현체가 adapter에 주입된다. 이 때 왼쪽에서 port와 그 구현체는 application 내부에 속하게 된다.
- **Secondary adapter는 port의 구현**체가 되고 application의 비즈니스 로직에 주입
    - Application 비즈니스 로직의 입장에서는 port의 interface만 알고 있다. **이 때 port는 application 내부에 속하지만 port의 구체적인 구현체는 application 외부에 속하게 된다.** 그리고 그 구현체는 외부 tool(SMS 라이브러리, ORM 등)을 감싸고 있다.


### 데이터 흐름

![Untitled (3)](https://github.com/5dotseven/cs-basic-study/assets/118906074/defe48ae-a425-42a0-8d85-53d12e72e11f)
- 기본적인 데이터 흐름은 **왼쪽(사용자의 요청)에서** 들어와서 **오른쪽**으로 처리가 됩니다.
- `Adapters` 를 통해 요청을 받은 후, `Application Services` 에 전달합니다. 전달하는 객체는 `Ports(interrface)`를 사용합니다.
- `Application Services` 로 들어온 요청은 `Domain Model` 로 전달합니다.
- `Domain Model` 은 비즈니스 로직을 처리하고 우측에 있는 `Adapters` 를 통해 외부의 데이터를 가져오거나 처리된 데이터를 외부로 저장합니다. 필요하다면 `Application Services` 는 도메인 모델의 처리 결과를 받아 다시 사용자에게 반환합니다.