# 운영체제(OS) CPU 스케줄링
> 개요: 프로세스는 CPU에 할당을 받아야 작업을 수행한다. 이때 여러 프로세스 중 누가 CPU의 할당을 받을 갓인가? 그리고 어떻게 받을 것 인가

CPU 스케줄링
---
CPU 를 잘 사용하기 위해 프로세스를 잘 배정 하는것
프로세스는 생성되고 난 두 여러 상태를 거치게 됨
여기서 `CPU 스케줄러`는 `Ready`상태의 프로세스 중 어떤 프로세스에게 CPU를 할당할지 결정함

이것을 스케줄링이라고 한다.

목적
- 사용률을 최대, 응답시간을 최소, 시스템 성늘을 향상시키는 것이 목적

디스패처(Dispatcher)
- CPU 스케줄러가 선택한 프로세스를 실행 가능한 상태로 만들어 주는 역할
- 디스패처는 Context Switching 을 진행하며, CPU의 모드 전환(커널 <-> 유저모드) 하여 프로세스 실행 준비를 함

고려사항
- 선점 vs 비선점 스케줄링
    - 선점: 빼앗을 수 있음 -> 선점이냐 비선점이냐는 프로세스가 CPU 할당 받으면 이를 운영체제가 강제로 회수할 수 있는 스케줄링 방식인지, 아닌지에 대한 내용이다
- 선점형 스케줄링
    - 운영체제가 필요하다고 판단하면 `실행 상태에 있는 프로세스의 작업을 중단시키고 새로운 작업을 시작`이 가능함
    - 적극적, 경제적, 빠른 응답성, 데이터 일관성 문제
- 비선점 스케줄링
    - 간단하고 예측 가능한 스케줄링을 제공, context switching 에 따른 오버헤드가 낮음
    - 응답 시간이 예측하기 어려움, 시스템의 전반적인 성능을 높이기 어려움
    - running -> ready
        - 현재 프로세스가 특정 이벤트를 기다려야 하는 경우
    - running -> waiting
        - 디스크에 I/O or 이벤트를 기다리는경우 (파일을 읽거나 쓰기 위해서)
    - running -> terminated
        - 완료 하고 종료가 되는 정우

<img width="712" alt="스크린샷 2024-05-23 오후 4 01 25" src="https://github.com/5dotseven/cs-basic-study/assets/144773042/db4f5a6e-c262-441a-9ecb-d8b7786bb061">

- admitted: 프로세스 생성이 가능 승인됨(커널 등록)
- 인터럽트 (interrupt): 예외, 입출력, 이벤트 등이 발생하여 현재 실행중인 프로세스를 준비 상태로 바꾸고, 해당 작업을 먼저 처리하는 것
- I/O or event wait: 실행 중인 프로세스가 입출력이나 이벤트를 처리해야 하는 경우 , 입출력/이벤트가 모두 끝날 떄 까지 대기 상태로 만듬
- I/O or event completion: 입출력/이벤트가 끝난 프로세스를 준비상태로 전환하여 스케줄러에게 선택 될 수 있도록 만드는 것


## 스케줄링 알고리즘
비선점
- FCFS (First - Come, First - Served)
    - 먼저 도착한 프로세스가 먼저 CPU를 할당받는 방식
    - 간단하고 공정한 방식이지만, 평군 대기 시간이나 응답 시간이 길어질 수 있음
- SJF (Shortest Job First)
    - 실행 시간이 가장 짧은 프로세스를 먼저 실행 -> 짧은 작업에 유리
    - 최적의 평균 대기 시간을 제공할 수 있지만, 실행 정확히 예측하기 어려운 단점이 있음
- HRN (Hightest Response-ratio Next)
    - 우선순위를 계산하여 점유 불평을을 보완한 방법 -> SJF 단점 보완
    - 우선순위 = (대기시간 + 실행시간) / 실행시간
- Priority
    - 정적 / 동적 으로 우선순위 부여 0> 높은 순서대로 처리
    - but 우선순위가 낮으면 무한정 기달려야함 -> Starvation(기아현상)
    - aging으로 해결


aging

선점
- RR(round-robin)
    - time slice로 나눠진 CPU time을 번갈아가며 실행
- Multilevel queue
    - 프로세스 들을 그룹화해서 그룹마다 큐를 두는 방식
    - 각 큐에는 서로 다른 우선순위를 부여
    - 각 큐마다 독립적인 스케줄링 알고리즘을 적용
