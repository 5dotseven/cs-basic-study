# 메모리 관리 전략

## 관리 방법

### Swapping

메모리에 적재되어 있으나 **현재 사용되지 않고 있는 프로세스를 관리**

표준 Swapping 방식인 round-robin과 같은 스케줄링이 메모리 관리를 담당하며 

다중 프로그래밍 환경에서 CPU 할당 시간이 끝난 프로세스의 메모리를 보조기억장치로 내보내고 다른 프로세스에 메모리를 할당한다.

메모리로 불러오는 과정을 **swap-in**, 보조 기억장치로 내보내는 과정을 **swap-out** 이라고 한다. 

### 압축 (Compaction)

외부 단편화를 해소하기 위한 방법으로 Scatterd Holes를 모으는 방법

램 영역을 압축해서, 디스크처럼 사용할 수 있는 기능이며 여기에 파일시스템이나 swap등을 적용해서 사용할 수 있다. 즉, 디스크를 잠시 램에 올려둔다거나, 반대로 램에 올라간 데이터 일부를 압축해서 잠시 ROM에 넣어뒀다가 이후에 끌어다 쓰는 등으로 활용할 수 있다.

하지만, 메모리를 과다하게 사용할 때에는 압축에 따른 오버헤드가 발생하므로 CPU 사용률이 증가하며, 스마트폰과 같은 휴대용 기기에서는 배터리 사용량도 증가한다는 단점이 있다.

### 1) 연속 메모리 할당

프로세스를 메모리에 연속적으로 할당하는 기법

할당과 제거를 반복하다보면 Scattered Holes가 생겨나고 이로 인한 외부 단편화가 발생

ㄴ 연속 메모리 할당에서 외부 단편화를 줄이기 위해 아래와 같이 할당한다

**a. 최초 적합 (First fit)**

- 가장 처음 만나는 빈 메모리 공간에 프로세스를 할당

**b. 최적 적합 (Best fit)**

- 빈 메모리 공간의 크기와 프로세스의 크기 차이가 가장 적은 곳에 프로세스를 할당

**c. 최악 적합 (Worst fit)**

- 빈 메모리 공간의 크기와 프로세스의 크기 차이가 가장 큰 곳에 프로세스를 할당
- 빈 메모리 공간에 또 다른 프로세스를 할당할 수 있도록 하기 위함

### 2) 페이징

가상 메모리 사용, 외부 단편화는 해결되지만 내부 단편화 존재

하나의 프로세스가 사용하는 **메모리 공간이 연속적이어야 한다는 제약을 없앤** 메모리 관리법.

**물리 메모리는 Frame 이라는 고정 크기로 분리**되어 있고,

**논리 메모리(프로세스가 점유하는)는 페이지라 불리는 고정 크기의 블록으로 분리**된다.(페이지 교체 알고리즘에 들어가는 페이지)

페이징 기법을 사용함으로써 논리 메모리는 물리 메모리에 저장될 때, 연속되어 저장될 필요가 없고 물리 메모리의 남는 프레임에 부분적으로 할당되어 **외부 단편화를 해결할 수 있는 큰 장점**이 있다.

하나의 프로세스가 사용하는 공간은 여러 개의 페이지로 나뉘어서 관리되고(논리 메모리에서), 개별 페이지는 순서에 상관없이 물리 메모리에 있는 프레임에 mapping 되어 저장된다

**단점** : **내부 단편화 문제의 비중이 늘어나게 된다**. 페이징은 논리메모리와 물리메모리간의 조각의 매핑이 기본에 있기 때문에 실행되는 프로세스보다 큰 물리 메모리 공간을 요구한다. 이때 내부 단편화가 발생할 수 있다.

### 3) 세그먼테이션(Segmentation)

가상 메모리 사용, 내부 단편화 해결, 외부 단편화 존재

페이징에서처럼 논리 메모리와 물리 메모리를 같은 크기의 블록이 아닌, **서로 다른 크기의 논리적 단위인 세그먼트(Segment)로 분할**

사용자가 두 개의 주소로 지정(세그먼트 번호 + 변위) 세그먼트 테이블에는 각 세그먼트의 기준(세그먼트의 시작 물리 주소)과 한계(세그먼트의 길이)를 저장

**단점** : 크기가 다른 세그먼트들이 메모리에 적재되고 제거되는 일이 반복되면, 메모리의 빈 공간들이 여기저기 생기는 **외부 단편화** 가 발생할 수 있다.

### 4) 세그먼테이션 - 페이징 혼용 기법

페이징과 세그먼테이션도 각각 내부 단편화와 외부 단편화가 발생하므로 두 가지 방법을 혼용해서 이러한 단편화를 최대한 줄이는 전략

프로세스를 세그먼트(논리적 기능 단위)로 나눈 다음에 세그먼트를 다시 페이징 단위로 나누어 관리한다.

**단점 :** 매핑 테이블을 두 번 거쳐야 하므로 속도가 느리다.
