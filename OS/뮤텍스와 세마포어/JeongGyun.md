# 운영체제(OS) 뮤텍스와 세마포어
>동시성 프로그래밍의 가장 큰 숙제 `공유자원 관리`

교착상태가 일어나면 서로 다른 프로세스가 점유하고 있는 자원을 요구하며 무한대로 기다리는 현상임
- 상호배제
- 점유과 대기
- 비선점
- 환경대기
  이 네가지 중 한 가지라도 일어나지 않으면 발생하지 않음

## 상호배제
: 자원은 한번에 한 프로세스만이 사용할 수 있어야한다. 기법에는 뮤텍스, 세마포어가 있음

## 뮤텍스(Mutex)
> 화장실이 하나 뿐인 식당
- 화장실을 가기 위해서는 카운터에서 열쇠를 받아가야함
- 당신이 화장실을 가려고 할 때 카운터에 가야함
- 당신은 화장실을 이용중
- 다른 손님이 와서 화장실을 가려고 카운터에감
- 열쇠가 없으므로 대기상태
- 또 다른 손님이 와서 화장실을 가려고 카운터에감
- 당연히 열쇠가 없으므로 대기
- 당신이 화장실에서 나옴
- 그러면 첫번째 대기자가 키를 받고 화장실을 들어감

여기서

화장실을 이용하는 사람이 -> `프로세스 or 쓰레드`
화장실 -> `공유자원`
화장실 열쇠 -> `공유자원에 접근하기 위한 오브젝트`

따라서

>`뮤덱스`는 공유자원애 접근하기 위한 오브젝트가 존재하며 이 오브젝트를 소유한 프로세스 or 쓰레드만이 공유자원제 접근 할 수있다.

## 세마포어(Semaphore)
>화장실에 여러개의 칸이 있는 식당. 그리고 화장실 입구에 현재 화장실의 빈 칸 개수를 보여주는 전광판이 존재
- 당신이 화장실에 가고싶음(화장실에 칸은 3개)
- 당신은 입구에서 빈 칸의 개수(3칸)를 확인하고 빈 칸이 1개 이상이라면 빈칸에 개수에서 하나를 빼고 화장실에 입장(2칸)
- 화장실에서 나올 땐 빈 칸의 개수를 하나 더해줌(3칸)
- 이후 3명에 사람이 왔고 칸의 개수는 0이됨
- 새로운 사람이 옴 빈카의 개수가 0이므로 빈칸의 개수가 1일이 될 떄 까지 기다림
- 한명이 화장실에서 나오면 칸의 개수가 1이 되고 기다리던 사람이 들어가면서 칸의 개수는 다시 0이 됨


여기서

화장실을 이용하는 사람이 -> `프로세스 or 쓰레드`
화장실 -> `공유자원`
전광판 -> `공유자원에 접근할 수 있는 쓰레드 or 프로세스의 개수`

따라서

>`세마포어`는 공유자원에 접근 할 수 있는 최대 허용치 만큼 동시 사용자(프로세스, 쓰레드) 접근을 허용하는 기법


출처
- https://medium.com/@kwoncharles/%EB%AE%A4%ED%85%8D%EC%8A%A4-mutex-%EC%99%80-%EC%84%B8%EB%A7%88%ED%8F%AC%EC%96%B4-semaphore-%EC%9D%98-%EC%B0%A8%EC%9D%B4-de6078d3c453
- https://incheol-jung.gitbook.io/docs/q-and-a/computer-science/undefined-1
