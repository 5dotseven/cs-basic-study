# 멀티 스레드

**여러 프로세서(CPU)** 인 경우 멀티 스레드를 통해 여러 작업이 동시에 수행 시킬 수 있다.

이는 프로세스의 스레드들이 각각 다른 프로세서에서 **병렬적**으로 수행될 수 있다는 것이다. 

CPU의 개수가 많아질수록 병렬화가 높아진다.

**하나의 프로세서(CPU)** 인 경우엔 멀티 스레드를 통해 **동시성(Concurrency)** 을 높일 수 있다. 실제로는 각각의 시간에 한 작업만 수행되지만, 빠른 컨텍스트 스위칭을 통해 병렬적으로 수행되는 것처럼 보이는 것이다. 

만약 한 스레드가 blocked(waiting) 되더라도 커널이 다른 스레드로 switch 시켜 실행할 수 있어서, 하나의 프로세서임에도 불구하고 빠른 처리가 가능하고 계산 속도가 증가한다.

### 멀티스레드의 장점

1. **응답성(Responsiveness)**
싱글 스레드인 경우, 작업이 끝나기 전까지 사용자에게 응답하지 않는다. 반면 멀티스레드인 경우 작업을 분리해서 수행하므로 실시간으로 사용자에게 응답할 수 있다.
2. **자원 공유(Resource sharing)**
프로세스는 오직 공유 메모리나 메시지 패싱을 이용해서 자원을 공유할 수 있지만, 스레드는 자신이 속한 프로세스 내의 스레드들과 메모리나 자원을 공유하여 효율적으로 사용할 수 있다.
3. **경제성(Economy)**
프로세스를 새로 생성하는 비용보다 스레드를 새로 생성하는 게 훨씬 싸다. 그리고 Context switching의 오버헤드 또한 스레드가 더 경제적이다. 실제로 Solaris에서 프로세스 생성은 스레드 생성보다 30배 느리고, switching은 5배 느리다.
4. **확장성(Scalability)**
싱글 스레드인 경우 한 프로세스는 오직 한 프로세서에서만 수행 가능하다. 반면 멀티 스레드인 경우 한 프로세스를 여러 프로세서에서 수행할 수 있으므로 훨씬 효율적이다.

### 주의점

- 서로 다른 스레드가 데이터와 힙 영역을 공유하기 때문에 다른 쓰레드의 값에 접근할 수 있다. 때문에 조심해야한다.
- 그렇기 때문에 멀티쓰레딩 환경에서는 **동기화 작업**이 필요하다.
- 동기화를 통해 **작업 처리 순서**를 컨트롤 하고 **공유 자원**에 대한 컨트롤을 신경 써야 한다.
- 이러한 동기화에서 **병목 현상**이 발생하여 성능이 저하될 수 있기에 주의하여야 한다.
- 동기화 처리가 필요한 부분에만 **synchronized** 키워드를 통해 동기화 하여야 하며 **AtomicInteger** , **AtomicLong**등과 같은 타입으로 동기화에 신경 써야 한다.
